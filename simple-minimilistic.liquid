<style>


  .patriotic-sale-container {
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
    min-height: 100vh;
    padding: 40px 20px;
  }

  .sale-header {
    margin-bottom: 30px;
    padding: 30px 20px;
    background: transparent;
    border-radius: 20px;
    color: #333;
    box-shadow: none;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 40px;
    min-height: 400px;
  }

  .independence-badge {
    background: #dc3545;
    color: white;
    padding: 8px 20px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 700;
    display: inline-block;
    margin-bottom: 20px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .hero-left {
    flex: 1;
    text-align: left;
    max-width: 500px;
  }

  .hero-right {
    flex: 0 0 350px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .sale-header h1 {
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 900;
    margin-bottom: 15px;
    color: #0071ce;
    letter-spacing: 1px;
    line-height: 1.1;
  }

  .sale-header h1 .gradient-text {
    background: linear-gradient(45deg, #0071ce 0%, #dc3545 50%, #0071ce 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .sale-header .discount {
    font-size: clamp(1.8rem, 4vw, 2.8rem);
    font-weight: 900;
    color: #dc3545;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    margin-bottom: 15px;
    letter-spacing: 1px;
  }

  .sale-subtitle {
    font-size: clamp(0.9rem, 1.8vw, 1.1rem);
    color: #666;
    font-weight: 400;
    line-height: 1.4;
    margin-bottom: 25px;
  }

  .header-timer {
    background: white;
    border: 2px solid #dc3545;
    border-radius: 12px;
    padding: 20px 15px;
    width: 100%;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  }

  .header-timer-label {
    color: #dc3545;
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 15px;
    text-transform: uppercase;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    letter-spacing: 1px;
  }

  .header-timer-label::before,
  .header-timer-label::after {
    content: '';
    color: #dc3545;
    font-size: 1.2rem;
    animation: flash 1.5s infinite;
  }

  .header-countdown {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 6px;
  }

  .header-countdown-unit {
    background: white;
    border: 2px solid #dc3545;
    border-radius: 8px;
    padding: 8px 4px;
    text-align: center;
    transition: transform 0.3s ease;
  }

  .header-countdown-unit:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
  }

  .header-countdown-unit span {
    display: block;
    font-size: 1.2rem;
    font-weight: 900;
    color: #dc3545;
    line-height: 1;
    margin-bottom: 2px;
    font-family: 'Arial', sans-serif;
  }

  .header-countdown-unit label {
    font-size: 0.6rem;
    font-weight: 700;
    color: #dc3545;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .hero-tab-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: 100%;
  }

  .hero-tab-button {
    padding: 15px 20px;
    background: white;
    border: 2px solid #0071ce;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 700;
    color: #0071ce;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: 0 2px 6px rgba(0, 113, 206, 0.1);
  }

  .hero-tab-button.active {
    background: #0071ce;
    border-color: #0071ce;
    color: white;
    transform: translateX(5px);
    box-shadow: 0 4px 12px rgba(0, 113, 206, 0.3);
  }

  .hero-tab-button:hover:not(.active) {
    background: #f0f8ff;
    border-color: #005ba6;
    color: #005ba6;
    transform: translateX(3px);
  }

  .shop-now-cta {
    background: linear-gradient(45deg, #0071ce, #dc3545);
    color: white;
    padding: 12px 30px;
    border: none;
    border-radius: 25px;
    font-weight: 900;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 5px 15px rgba(0, 113, 206, 0.3);
  }

  .shop-now-cta:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(220, 53, 69, 0.5);
    color: white;
    text-decoration: none;
    filter: brightness(1.1);
  }

  .tabs-container {
    max-width: 100%;
    margin: 0 auto;
  }

  .sticky-tab-container {
    position: fixed;
    top: 0;
    left: 55%;
    transform: translateX(-55%) translateY(-100%);
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
    padding: 5px 5px;
    z-index: 800;
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.15);
    transition: transform 0.3s ease;
    border-bottom: 3px solid #0071ce;
    max-width: 1100px;
    width: calc(100% - 40px);
    border-radius: 0 0 15px 15px;
  }

  .sticky-tab-container.show {
    transform: translateX(-50%) translateY(0);
  }

  .sticky-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
  }

  .sticky-tabs {
    display: flex;
    gap: 10px;
  }

  .sticky-tab-button {
    padding: 10px 25px;
    background: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 20px;
    font-size: 1rem;
    font-weight: 700;
    color: #495057;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
  }

  .sticky-tab-button.active {
    background: linear-gradient(45deg, #1E3A8A, #0071ce);
    color: white;
    border-color: #0071ce;
    transform: translateY(-1px);
    box-shadow: 0 3px 10px rgba(0, 113, 206, 0.3);
  }

  .sticky-timer {
    background: white;
    border: 2px solid #dc3545;
    border-radius: 10px;
    padding: 10px 15px;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .sticky-timer-label {
    color: #dc3545;
    font-size: 0.8rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    white-space: nowrap;
  }

  .sticky-countdown {
    display: flex;
    gap: 8px;
  }

  .sticky-countdown-unit {
    background: white;
    border: 1px solid #dc3545;
    border-radius: 4px;
    padding: 4px 6px;
    text-align: center;
    min-width: 35px;
  }

  .sticky-countdown-unit span {
    display: block;
    font-size: 1rem;
    font-weight: 900;
    color: #dc3545;
    line-height: 1;
    margin-bottom: 2px;
  }

  .sticky-countdown-unit label {
    font-size: 0.5rem;
    font-weight: 700;
    color: #dc3545;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .tab-buttons {
    display: flex;
    justify-content: center;
    margin-bottom: 40px;
    gap: 10px;
  }

  .tab-button {
    padding: 15px 40px;
    background: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 25px;
    font-size: 1.2rem;
    font-weight: 700;
    color: #495057;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
  }

  .tab-button.active {
    background: linear-gradient(45deg, #1E3A8A, #0071ce);
    color: white;
    border-color: #0071ce;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 113, 206, 0.3);
  }

  .tab-button:hover:not(.active) {
    background: #e9ecef;
    border-color: #adb5bd;
    transform: translateY(-1px);
  }

  .tab-content {
    display: block;
  }

  .tab-content.active {
    display: block;
  }

  .collection-section {
    margin-bottom: 80px;
    background: white;
    border-radius: 20px;
    overflow: hidden;
    border: 2px solid #e5e7eb;
  }

  .collection-header {
    padding: 20px 40px;
    background: white;
    display: flex;
    align-items: center;
    gap: 20px;
    min-height: auto;
  }

  .collection-header.reverse {
    flex-direction: row;
  }

  .collection-header-content {
    flex: 1;
  }

  .collection-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: #0071ce;
    margin-bottom: 10px;
    line-height: 1.2;
  }

  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px;
    padding: 40px;
  }

  .product-card {
    background: white;
    border-radius: 15px;
    overflow: hidden;
    transition: all 0.3s ease;
    border: 2px solid #0071ce;
    position: relative;
    max-width: 350px;
    width: 100%;
    margin: 0 auto;
  }

  .product-card:hover {
    transform: translateY(-2px);
    border-color: #005ba6;
  }

  .discount-badge {
    position: absolute;
    top: -0px;
    right: -8px;
    z-index: 10;
  }

  .discount-label {
    background: #0071ce !important;
    color: white !important;
    padding: 6px 14px 6px 10px;
    font-weight: 700;
    font-size: 0.75rem;
    text-align: center;
    position: relative;
    display: inline-flex;
    align-items: center;
    min-height: 24px;
    border-radius: 0 3px 3px 0;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
  }

  .discount-label::before {
    content: 'Discount';
    position: absolute;
    right: 100%;
    top: 0;
    bottom: 0;
    background: #dc3545;
    color: white;
    padding: 6px 8px;
    font-size: 0.6rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    border-radius: 3px 0 0 3px;
    white-space: nowrap;
    min-height: 24px;
    box-sizing: border-box;
  }

  .discount-label::after {
    content: '';
    position: absolute;
    right: 100%;
    top: 100%;
    width: 0;
    height: 0;
    border-left: 5px solid #a91e2e;
    border-bottom: 5px solid transparent;
  }

  @keyframes glow {
    from { opacity: 0.7; }
    to { opacity: 1; }
  }

  .product-image {
    height: 220px; /* Increased height */
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 30px 20px;
    border-bottom: 1px solid #e0e0e0;
  }

  .product-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  .product-content {
    padding: 20px;
  }

  .product-title {
    font-size: 1rem;
    font-weight: 600;
    color: #0071ce; /* Brand blue color */
    margin-bottom: 12px;
    line-height: 1.4;
    min-height: 48px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .product-sku {
    color: #666;
    font-size: 0.85rem;
    margin-bottom: 6px; /* Reduced margin */
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    cursor: pointer;
    gap: 8px;
  }

  .copy-icon {
    width: 16px;
    height: 16px;
    cursor: pointer;
    color: #0071ce;
    transition: color 0.2s ease;
  }

  .copy-icon:hover {
    color: #005ba6;
  }

  .product-price {
    margin-bottom: 12px; /* Reduced margin */
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .original-price {
    text-decoration: line-through;
    color: #999;
    font-size: 0.9rem;
  }

  .sale-price {
    color: #0071ce;
    font-size: 1rem;
    font-weight: 700;
    text-decoration: line-through; /* Strikethrough */
    font-size: 0.9rem; /* Reduced font size */
  }

  .final-price {
    color: #dc3545;
    font-size: 1.6rem;
    font-weight: 900;
    margin-left: 10px;
  }

  .smart-savings {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 6px 8px; /* Further reduced padding */
    margin: 8px 0 12px 0; /* Reduced margins */
    border: 1px solid #e9ecef;
  }

  .smart-savings-header {
    display: flex;
    align-items: center;
    font-weight: 700;
    color: #495057;
    font-size: 0.85rem; /* Slightly smaller font */
    margin-bottom: 4px; /* Reduced margin */
    justify-content: space-between;
    cursor: pointer;
  }

  .savings-preview {
    font-size: 0.75rem; /* Smaller font */
    color: #6c757d;
    margin: 0; /* Removed margins */
    padding: 0; /* Removed padding */
    line-height: 1.2; /* Tighter line height */
  }

  .savings-option {
    background: #d1ecf1;
    border: 2px solid #bee5eb;
    border-radius: 6px;
    padding: 8px 10px;
    position: relative;
  }

  .savings-option.most-popular::before {
    content: 'MOST POPULAR';
    position: absolute;
    top: -8px;
    left: 50%;
    transform: translateX(-50%);
    background: #28a745;
    color: white;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 0.65rem;
    font-weight: 700;
  }

  .savings-text {
    color: #121212;
    font-size: 0.85rem;
    font-weight: 600;
    margin-bottom: 2px;
  }

  .savings-price {
    color: #495057;
    font-size: 0.8rem;
  }

  .savings-amount {
    font-weight: 700;
  }

  .savings-details {
    display: none;
    padding-top: 10px;
  }

  .smart-savings-toggle {
    cursor: pointer;
    font-size: 0.8rem;
    color: #0071ce;
    user-select: none;
  }

  .smart-savings.expanded .savings-details {
    display: block;
  }

  .smart-savings.expanded .smart-savings-toggle {
    transform: rotate(180deg);
  }

  .product-cta {
    background: #0071ce;
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 25px;
    font-weight: 700;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
    width: 100%;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .product-cta:hover {
    background: #005ba6;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 113, 206, 0.4);
    color: white;
    text-decoration: none;
  }

  .product-card {
    cursor: pointer;
  }

  /* Toast notification styles */
  .toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: white;
    padding: 12px 24px;
    border-radius: 25px;
    font-size: 0.9rem;
    font-weight: 600;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }

  .toast.show {
    opacity: 1;
  }

  @media (max-width: 768px) {
    .sticky-tab-container {
      width: calc(100% - 20px);
      padding: 12px 15px;
      left: 50%;
      transform: translateX(-50%) translateY(-100%);
    }

    .sticky-tab-container.show {
      transform: translateX(-50%) translateY(0);
    }

    .sticky-content {
      flex-direction: column;
      gap: 10px;
    }

    .sticky-tabs {
      gap: 5px;
    }

    .sticky-tab-button {
      padding: 8px 12px;
      font-size: 0.8rem;
    }

    .sticky-timer {
      padding: 8px 12px;
      gap: 10px;
    }

    .sticky-countdown {
      gap: 5px;
    }

    .sticky-countdown-unit {
      min-width: 30px;
      padding: 3px 4px;
    }

    .sticky-countdown-unit span {
      font-size: 0.9rem;
    }

    .sticky-countdown-unit label {
      font-size: 0.6rem;
    }

    .patriotic-sale-container {
      padding: 20px 10px;
    }

    .sale-header {
      padding: 25px 15px;
      flex-direction: column;
      text-align: center;
      min-height: auto;
      gap: 25px;
    }

    .hero-left {
      text-align: center;
      max-width: 100%;
    }

    .hero-right {
      flex: none;
      width: 100%;
      max-width: 350px;
      margin: 0 auto;
    }

    .header-timer {
      padding: 18px 15px;
    }

    .header-countdown {
      gap: 4px;
    }

    .header-countdown-unit {
      padding: 6px 4px;
    }

    .header-countdown-unit span {
      font-size: 1rem;
    }

    .header-countdown-unit label {
      font-size: 0.55rem;
    }

    .hero-tab-buttons {
      flex-direction: row;
      gap: 8px;
    }

    .hero-tab-button {
      padding: 12px 12px;
      font-size: 0.8rem;
    }

    .shop-now-cta {
      padding: 12px 25px;
      font-size: 0.9rem;
      margin-top: 15px;
    }

    .tab-buttons {
      flex-direction: column;
      align-items: center;
    }

    .tab-button {
      width: 100%;
      max-width: 300px;
      margin-bottom: 10px;
    }

    .products-grid {
      grid-template-columns: 1fr;
      gap: 20px;
      padding: 20px;
    }

    .collection-header {
      padding: 15px 20px;
      flex-direction: column;
      text-align: center;
      gap: 15px;
      min-height: auto;
    }

    .collection-title {
      font-size: 1.5rem;
    }
  }
  .discount-badge {
    position: absolute;
    top: -0px; /* Adjust as needed */
    right: -5px; /* Adjust as needed */
    z-index: 10;
}

/* Apple-style Popup Overlay */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  z-index: 10000;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.overlay.show {
  opacity: 1;
  visibility: visible;
}

/* Apple-style Popup */
.add-to-cart-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
  z-index: 10001;
  max-width: 480px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.add-to-cart-popup.show {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, -50%) scale(1);
}

.popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 24px 0 24px;
  margin-bottom: 20px;
  position: relative;
}

.popup-discount-badge {
  position: absolute;
  top: 10px;
  right: 60px;
  background: #dc3545;
  color: white;
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
}

.popup-close {
  background: rgba(120, 120, 128, 0.12);
  border: none;
  border-radius: 50%;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.2s ease;
  color: #666;
  font-size: 16px;
  font-weight: 500;
}

.popup-close:hover {
  background: rgba(120, 120, 128, 0.2);
}

.popup-content {
  padding: 0 24px 24px 24px;
}

.popup-product-image {
  width: 80px;
  height: 80px;
  background: #f8f9fa;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 20px auto;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.popup-product-image img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 12px;
}

.popup-product-title {
  font-size: 18px;
  font-weight: 600;
  color: #1d1d1f;
  margin-bottom: 8px;
  line-height: 1.3;
  text-align: center;
}

.popup-product-sku {
```html
  font-size: 14px;
  color: #86868b;
  margin-bottom: 12px;
  text-align: center;
}

.popup-product-price {
  margin-bottom: 20px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.popup-original-price {
  text-decoration: line-through;
  color: #999;
  font-size: 0.9rem;
}

.popup-sale-price {
  color: #0071ce;
  font-size: 0.9rem;
  font-weight: 600;
  text-decoration: line-through;
}

.popup-final-price {
  color: #dc3545;
  font-size: 1.6rem;
  font-weight: 700;
}

.popup-smart-savings {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 12px 16px;
  margin-bottom: 20px;
  border: 1px solid #e9ecef;
}

.popup-smart-savings-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 600;
  color: #495057;
  font-size: 14px;
  margin-bottom: 8px;
  cursor: pointer;
}

.popup-savings-preview {
  font-size: 12px;
  color: #6c757d;
  margin: 0;
  line-height: 1.2;
}

.popup-savings-details {
  display: none;
  padding-top: 12px;
}

.popup-smart-savings.expanded .popup-savings-details {
  display: block;
}

.popup-smart-savings.expanded .popup-smart-savings-toggle {
  transform: rotate(180deg);
}

.popup-savings-details {
  display: flex;
  /* flex-direction: column; */ /* Change to row */
  flex-direction: row; /* Change to row */
  gap: 8px;
  margin-top: 12px;
}

.popup-savings-option {
  background: #d1ecf1;
  border: 2px solid #bee5eb;
  border-radius: 8px;
  padding: 10px 8px;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;
  text-align: center;
  flex: 1; /* Equal width distribution */
}

.popup-savings-option:hover {
  border-color: #0071ce;
  background: #e3f2fd;
}

.popup-savings-option.selected {
  border-color: #0071ce;
  background: #1976d2;
  color: white;
}

.popup-savings-option.selected .popup-savings-text,
.popup-savings-option.selected .popup-savings-price {
  color: white;
}

.popup-savings-label {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  color: white;
  padding: 2px 6px;
  border-radius: 8px;
  font-size: 8px;
  font-weight: 700;
  white-space: nowrap;
}

.popup-savings-2 .popup-savings-label {
  background: #28a745;
}

.popup-savings-3 .popup-savings-label {
  background: #1976d2;
}

.popup-savings-5 .popup-savings-label {
  background: #ff5722;
}

.popup-savings-text {
  color: #121212;
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 4px;
}

.popup-savings-price {
  color: #495057;
  font-size: 10px;
}

.popup-savings-amount {
  font-weight: 700;
}

.popup-quantity-section {
  margin-bottom: 24px;
}

.popup-quantity-label {
  font-size: 16px;
  font-weight: 500;
  color: #1d1d1f;
  margin-bottom: 12px;
  text-align: center;
  display: block;
}

.popup-quantity-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
}

.popup-quantity-btn {
  background: rgba(0, 0, 0, 0.04);
  border: none;
  border-radius: 8px;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 18px;
  font-weight: 500;
  color: #1d1d1f;
  user-select: none;
}

.popup-quantity-btn:hover {
  background: rgba(0, 0, 0, 0.08);
  transform: scale(1.05);
}

.popup-quantity-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  transform: none;
}

.popup-quantity-input {
  background: rgba(0, 0, 0, 0.04);
  border: none;
  border-radius: 8px;
  width: 60px;
  height: 44px;
  text-align: center;
  font-size: 16px;
  font-weight: 500;
  color: #1d1d1f;
  outline: none;
}

/* Hide any extra quantity controls */
.popup-quantity-section .popup-quantity-btn:nth-of-type(n+3) {
  display: none;
}

.popup-add-to-cart {
  background: #0071ce;
  color: white;
  border: none;
  border-radius: 12px;
  padding: 16px 24px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  width: 100%;
  margin-bottom: 20px;
}

.popup-add-to-cart:hover {
  background: #005ba6;
  transform: translateY(-1px);
}

.popup-recommended {
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  padding-top: 20px;
  text-align: center;
}

.popup-recommended h3 {
  font-size: 16px;
  font-weight: 600;
  color: #1d1d1f;
  margin-bottom: 12px;
}

.popup-recommended p {
  font-size: 14px;
  color: #86868b;
  margin: 0;
}

/* Cart Notifications */
.cart-notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background: white;
  border-radius: 12px;
  padding: 16px 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  z-index: 10002;
  opacity: 0;
  transform: translateX(100%);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border-left: 4px solid #28a745;
  max-width: 350px;
}

.cart-notification.error {
  border-left-color: #dc3545;
}

.cart-notification.show {
  opacity: 1;
  transform: translateX(0);
}

.notification-content {
  display: flex;
  align-items: center;
  gap: 12px;
}

.notification-icon {
  width: 24px;
  height: 24px;
  background: #28a745;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  flex-shrink: 0;
}

.cart-notification.error .notification-icon {
  background: #dc3545;
}

.notification-text {
  font-size: 14px;
  font-weight: 500;
  color: #1d1d1f;
}

/* Checkout Section */
.popup-checkout-section {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.checkout-buttons {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
}

.checkout-btn {
  flex: 1;
  padding: 14px 20px;
  border: none;
  border-radius: 12px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.checkout-btn.primary {
  background: #0071ce;
  color: white;
}

.checkout-btn.primary:hover {
  background: #005ba6;
  transform: translateY(-1px);
}

.checkout-btn.secondary {
  background: rgba(0, 0, 0, 0.04);
  color: #1d1d1f;
}

.checkout-btn.secondary:hover {
  background: rgba(0, 0, 0, 0.08);
}

.checkout-icon {
  font-size: 16px;
}

/* Related Products */
.related-products-section h3 {
  font-size: 16px;
  font-weight: 600;
  color: #1d1d1f;
  margin-bottom: 16px;
  text-align: center;
}

.related-products-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.related-product-card {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.related-product-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border-color: #0071ce;
}

.related-product-image {
  width: 60px;
  height: 60px;
  background: white;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 8px auto;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.related-product-image img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 6px;
}

.related-placeholder {
  font-size: 24px;
  color: #666;
}

.related-product-info h4 {
  font-size: 12px;
  font-weight: 600;
  color: #1d1d1f;
  margin-bottom: 6px;
  line-height: 1.3;
  text-align: center;
}

.related-product-price {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  margin-bottom: 6px;
}

.related-sale-price {
  font-size: 11px;
  color: #999;
  text-decoration: line-through;
}

.related-final-price {
  font-size: 12px;
  font-weight: 600;
  color: #dc3545;
}

.related-discount-badge {
  background: #dc3545;
  color: white;
  padding: 2px 6px;
  border-radius: 6px;
  font-size: 10px;
  font-weight: 600;
  text-align: center;
}

/* Mobile Responsive */
@media (max-width: 480px) {
  .add-to-cart-popup {
    max-width: 95%;
    margin: 20px;
    border-radius: 16px;
  }

  .popup-header {
    padding: 16px 20px 0 20px;
  }

  .popup-content {
    padding: 0 20px 20px 20px;
  }

  .popup-product-title {
    font-size: 16px;
  }

  .popup-product-price {
    font-size: 18px;
  }

  .cart-notification {
    top: 10px;
    right: 10px;
    left: 10px;
    max-width: none;
  }

  .checkout-buttons {
    flex-direction: column;
  }

  .related-products-grid {
    grid-template-columns: 1fr;
  }

  .popup-savings-details {
    gap: 6px;
  }

  .popup-savings-text {
    font-size: 11px;
  }

  .popup-savings-price {
    font-size: 9px;
  }
}
</style>

<div class="patriotic-sale-container">
  <div class="sale-header">
    <div class="hero-left">
      <div class="independence-badge">US Independence Day Special</div>
      <h1>Our <span class="gradient-text">Biggest</span> Patriotic <span class="gradient-text">Sale</span> of the <span class="gradient-text">Year!</span></h1>
      <div class="discount">UP TO 50% OFF</div>
      {% comment %} <div class="sale-subtitle">
        Celebrate America's independence with our biggest sale of the year!
      </div> {% endcomment %}
      <a href="#products-section" class="shop-now-cta" onclick="scrollToProducts()">Shop Now & Save Big!</a>
    </div>

    <div class="hero-right">
      <div class="header-timer">
        <div class="header-timer-label">Sale Ends July 31st</div>
        <div class="header-countdown">
          <div class="header-countdown-unit">
            <span id="days">02</span>
            <label>Days</label>
          </div>
          <div class="header-countdown-unit">
            <span id="hours">06</span>
            <label>Hours</label>
          </div>
          <div class="header-countdown-unit">
            <span id="minutes">25</span>
            <label>Mins</label>
          </div>
          <div class="header-countdown-unit">
            <span id="seconds">41</span>
            <label>Secs</label>
          </div>
        </div>
      </div>
    </div>
  </div>



  <div class="tabs-container" id="products-section">

      <!-- Bioprocess Products -->

      <!-- EZclear® Rectangular Carboy (PC) Collection - 20% Off -->
      {% assign ezclear_carboy_collection = collections['ezclear-rectangular-carboy-pc-20-off-us-independence-day-sale-25'] %}
      {% if ezclear_carboy_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZclear® Rectangular Carboy (PC)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezclear_carboy_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">20% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="32"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio® Carboy (PC) Collection  - 20% Off -->
      {% assign pc_carboy_collection = collections['ezbio-carboy-pc-20-off-us-independence-day-sale-25'] %}
      {% if pc_carboy_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Carboy (PC)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in pc_carboy_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">20% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="20"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio® Titanium Round Carboy (PC) Collection - 15% Off -->
      {% assign pc_tr_carboy_collection = collections['ezbio-titanium-round-carboy-pc-15-off-us-independence-day-sale-25'] %}
      {% if pc_tr_carboy_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Titanium Round Carboy (PC)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in pc_tr_carboy_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">15% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="15"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio® Media bottle (PC) Collection - 12% & 10% Off -->
      {% assign ezbio_bottles_12_collection = collections['ezbio-media-bottle-pc-12-off-us-independence-day-sale-25'] %}
      {% assign ezbio_bottles_10_collection = collections['ezbio-media-bottle-pc-10-off-us-independence-day-sale-25'] %}
      {% assign has_products = false %}
      {% if ezbio_bottles_12_collection.products.size > 0 or ezbio_bottles_10_collection.products.size > 0 %}
        {% assign has_products = true %}
      {% endif %}

      {% if has_products %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Media bottle (PC)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezbio_bottles_12_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">12% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="12"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}

          {% for product in ezbio_bottles_10_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">10% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="10"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio® Titanium Square Media Bottles (PETG) Collection - 12% Off -->
      {% assign ezbio_ts_bottles_collection = collections['ezbio-titanium-square-media-bottles-petg-12-off-us-independence-day-sale-25'] %}
      {% if ezbio_ts_bottles_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Titanium Square Media Bottles (PETG)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezbio_ts_bottles_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">12% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="12"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio® Pure PFA Bottle Collection - 40% Off -->
      {% assign pfa_bottles_collection = collections['ezbio-pure-pfa-bottle-40-off-us-independence-day-sale-25'] %}
      {% if pfa_bottles_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Pure PFA Bottle</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in pfa_bottles_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">40% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="40"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- CPC® AseptiQuik G Sanitary Connector Collection - 20% Off -->
      {% assign aqg_collection = collections['cpc-aseptiquik-g-sanitary-connector-20-off-us-independence-day-sale-25'] %}
      {% if aqg_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">CPC® AseptiQuik G Sanitary Connector</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in aqg_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">20% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="50"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
   {% endif %}

    <!-- CPC® AseptiQuik S Connector  Collection - 50% Off --> 
    {% assign aqs_collection = collections['cpc-aseptiquik-s-connector-50-off-us-independence-day-sale-25'] %}
      {% if aqs_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">CPC® AseptiQuik S Connector</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in aqs_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">50% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="50"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
   {% endif %}

      <!-- CPC® Steam Thru Connectors Collection - 50% Off -->
      {% assign cpc_stream_thru_connectors_collection = collections['cpc-steam-thru-connectors-50-off-us-independence-day-sale-25'] %}
      {% if cpc_stream_thru_connectors_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">CPC® Steam Thru Connectors</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in cpc_stream_thru_connectors_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">50% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="50"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio® Bottle Assembly (PC) Collection - 12% Off -->
      {% assign ezbio_bottle_assembly_pc_collection = collections['ezbio-bottle-assembly-pc-12-off-us-independence-day-sale-25'] %}
      {% if ezbio_bottle_assembly_pc_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Bottle Assembly (PC)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezbio_bottle_assembly_pc_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">12% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="12"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

    <!-- Laboratory Products -->

      <!-- EZLabpure™ Round Carboy (PP) Collection - 25% Off -->
      {% assign ezlabpure_carboy_collection = collections['ezlabpure-round-carboy-pp-25-off-us-independence-day-sale-25'] %}
      {% if ezlabpure_carboy_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZLabpure™ Round Carboy (PP)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezlabpure_carboy_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">25% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="25"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZgrip® Carboy (PP) Collection - 32% Off -->
      {% assign ezgrip_carboy_collection = collections['ezgrip-carboy-pp-32-off-us-independence-day-sale-25'] %}
      {% if ezgrip_carboy_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZgrip® Carboy (PP)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezgrip_carboy_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">32% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="32"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

       <!-- EZBio® Carboy (PC) Lab Collection - 32% Off -->
      {% assign ezbio_carboypc_collection = collections['ezbio-carboy-pc-lab-32-off-us-independence-day-sale-25'] %}
      {% if ezbio_carboypc_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Carboy (PC)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezbio_carboypc_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">32% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="32"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- EZBio Carboy Collection -->
      {% assign ezbio_carboypp_collection = collections['ezbio-carboy-pp-lab-32-off-us-independence-day-sale-25'] %}
      {% if ezbio_carboypp_collection.products.size > 0 %}
      <div class="collection-section">
        <div class="collection-header">
          <div class="collection-header-content">
            <h2 class="collection-title">EZBio® Carboy (PP)</h2>
          </div>
        </div>
        <div class="products-grid">
          {% for product in ezbio_carboypp_collection.products %}
          <div class="product-card" onclick="window.open('{{ product.url }}', '_blank')">
            <div class="discount-badge">
              <div class="discount-label">32% OFF</div>
            </div>
            <div class="product-image">
              {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '300x300' }}" alt="{{ product.title }}">
              {% else %}
                <div style="color: #6c757d; font-size: 1rem; text-align: center;">Product Image</div>
              {% endif %}
            </div>
            <div class="product-content">
              <h3 class="product-title">{{ product.title }}</h3>
              {% if product.variants.first.sku != blank %}
                <div class="product-sku" onclick="copyToClipboard('{{ product.variants.first.sku }}', event)">
                  {{ product.variants.first.sku }}
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
                  </svg>
                </div>
              {% endif %}
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="original-price">${{ product.compare_at_price | money_without_currency }}</span>
                {% endif %}
                <span class="sale-price">${{ product.price | money_without_currency }}</span>
                <span class="final-price" data-sale-price="{{ product.price | money_without_currency }}" data-discount="32"></span>
              </div>
              <button class="product-cta" onclick="openAddToCartPopupWithEvent(event, {{ product.id }}, '{{ product.title | escape }}', '{{ product.featured_image | img_url: '300x300' }}', '{{ product.variants.first.sku }}', {{ product.price }}, {{ product.variants.first.id }});">Shop Now</button>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

    </div>
</div>

<div id="addToCartPopup" class="add-to-cart-popup">
    <div class="popup-header">
        <div></div>
        <div class="popup-discount-badge" id="popupDiscountBadge"></div>
        <button class="popup-close" onclick="closeAddToCartPopup()">×</button>
    </div>

    <div class="popup-content">
        <div class="popup-product-image">
            <img id="popupProductImage" src="" alt="Product Image">
        </div>

        <h2 class="popup-product-title" id="popupProductTitle"></h2>
        <div class="popup-product-sku">SKU: <span id="popupProductSKU"></span></div>

        <div class="popup-product-price">
             {% comment %} Add the original price in popup {% endcomment %}
            <span class="popup-original-price" id="popupOriginalPrice" style="display: none;">$0.00</span>
            <span class="popup-sale-price">${{ product.price | money_without_currency }}<span id="popupSalePrice"></span></span>

            {% comment %} Add strikethrough to sale price and decrease font size in popup {% endcomment %}

            <span class="popup-final-price" id="popupFinalPrice">$0.00</span>
        </div>

        <div class="popup-smart-savings">
            <div class="popup-smart-savings-header">
                <div style="display: flex; align-items: center;">
                    <img src="https://cdn.shopify.com/s/files/1/1064/0118/files/New_Icon.f3cc687da18d1b9a7778597a17d03fcc.gif?v=1712245731" alt="Smart Savings" style="height: 16px; width: 16px; margin-right: 4px;">
                    Smart Savings
                </div>
            </div>
            <div class="popup-savings-preview">Buy 2 items and save $<span class="popup-savings-preview-amount" id="popupSavingsPreview">0.00</span>/item</div>
            <div class="popup-savings-details" style="display: flex;">
                <div class="popup-savings-option popup-savings-2" onclick="selectSavingsOption(2)">
                    <div class="popup-savings-label">MOST POPULAR</div>
                    <div class="popup-savings-text">More than 2 Items</div>
                    <div class="popup-savings-price">and save $<span class="popup-savings-amount" id="popupSavingsAmount2">0.00</span>/item</div>
                </div>
                <div class="popup-savings-option popup-savings-3" onclick="selectSavingsOption(3)">
                    <div class="popup-savings-label">BEST VALUE</div>
                    <div class="popup-savings-text">More than 3 Items</div>
                    <div class="popup-savings-price">and save $<span class="popup-savings-amount" id="popupSavingsAmount3">0.00</span>/item</div>
                </div>
                <div class="popup-savings-option popup-savings-5" onclick="selectSavingsOption(5)">
                    <div class="popup-savings-label">MOST SAVINGS</div>
                    <div class="popup-savings-text">More than 5 Items</div>
                    <div class="popup-savings-price">and save $<span class="popup-savings-amount" id="popupSavingsAmount5">0.00</span>/item</div>
                </div>
            </div>
        </div>

        <div class="popup-quantity-section">
            <label class="popup-quantity-label">Quantity</label>
            <div class="popup-quantity-controls">
                <button class="popup-quantity-btn" onclick="decreaseQuantity()" type="button">−</button>
                <input type="number" class="popup-quantity-input" id="popupQuantity" value="1" min="1" readonly>
                <button class="popup-quantity-btn" onclick="increaseQuantity()" type="button">+</button>
            </div>
        </div>

        <button class="popup-add-to-cart" onclick="addToCart()">Add to Cart</button>

        <div class="popup-recommended">
            {% comment %} <h3>You might also like</h3>
            <p>More products coming soon...</p> {% endcomment %}
        </div>
    </div>
</div>

<div id="overlay" class="overlay" onclick="closeAddToCartPopup()"></div>

<script>

// Countdown Timer
// Global function for opening popup with event handling
function openAddToCartPopupWithEvent(event, productId, productTitle, productImage, productSKU, productPrice, productVariantId) {
    event.stopPropagation();
    openAddToCartPopup(productId, productTitle, productImage, productSKU, productPrice, productVariantId, event);
}

function updateCountdown() {
  // Set the date we're counting down to (July 31st, 2024 at 11:59 PM)
  const countDownDate = new Date('2025-07-31T23:59:59').getTime();

  const timer = setInterval(function() {
    const now = new Date().getTime();
    const distance = countDownDate - now;

    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    const dayStr = String(days).padStart(2, '0');
    const hourStr = String(hours).padStart(2, '0');
    const minuteStr = String(minutes).padStart(2, '0');
    const secondStr = String(seconds).padStart(2, '0');

    // Update main timer
    document.getElementById("days").innerHTML = dayStr;
    document.getElementById("hours").innerHTML = hourStr;
    document.getElementById("minutes").innerHTML = minuteStr;
    document.getElementById("seconds").innerHTML = secondStr;

    // Update sticky timer
    document.getElementById("sticky-days").innerHTML = dayStr;
    document.getElementById("sticky-hours").innerHTML = hourStr;
    document.getElementById("sticky-minutes").innerHTML = minuteStr;
    document.getElementById("sticky-seconds").innerHTML = secondStr;

    if (distance < 0) {
      clearInterval(timer);
      // Reset both timers
      ["days", "hours", "minutes", "seconds", "sticky-days", "sticky-hours", "sticky-minutes", "sticky-seconds"].forEach(id => {
        const element = document.getElementById(id);
        if (element) element.innerHTML = "00";
      });
    }
  }, 1000);
}

// Scroll to products function
function scrollToProducts() {
  const productsSection = document.getElementById('products-section');
  if (productsSection) {
    productsSection.scrollIntoView({ 
      behavior: 'smooth',
      block: 'start'
    });
  }
}

// Calculate final prices and smart savings
function calculatePricesAndSavings() {
  // Calculate final prices based on discount percentage from the actual discount label
  const finalPrices = document.querySelectorAll('.final-price');
  finalPrices.forEach(finalPrice => {
    const salePrice = parseFloat(finalPrice.dataset.salePrice.replace(/,/g, ''));

    // Get the actual discount percentage from the discount label in the same product card
    const productCard = finalPrice.closest('.product-card');
    const discountLabel = productCard.querySelector('.discount-label');
    const discountText = discountLabel.textContent;
    const actualDiscountPercentage = parseInt(discountText.replace(/[^\d]/g, ''));

    const finalPriceAmount = salePrice - (salePrice * actualDiscountPercentage / 100);

    // Format price consistently with 2 decimal places
    finalPrice.textContent = '$' + finalPriceAmount.toFixed(2);
  });

  // Calculate smart savings amounts for expanded sections
  const savingsAmounts = document.querySelectorAll('.savings-amount');
  savingsAmounts.forEach(savingsAmount => {
    const basePrice = parseFloat(savingsAmount.dataset.basePrice.replace(/,/g, ''));
    const qty = parseInt(savingsAmount.dataset.qty);

    // Find the discount percentage from the product card's discount badge
    const productCard = savingsAmount.closest('.product-card');
    const discountLabel = productCard.querySelector('.discount-label');
    const discountText = discountLabel.textContent;
    const discountPercentage = parseInt(discountText.replace(/[^\d]/g, ''));
    const discountRate = discountPercentage / 100;

    const regularTotal = basePrice * qty;
    const discountedTotal = regularTotal * (1 - discountRate);
    const totalSavings = regularTotal - discountedTotal;
    const perItemSavings = totalSavings / qty;

    savingsAmount.textContent = perItemSavings.toFixed(2);
  });

  // Calculate smart savings preview amounts - must match the savings amounts
  const savingsPreviewAmounts = document.querySelectorAll('.savings-preview-amount');
  savingsPreviewAmounts.forEach(savingsPreviewAmount => {
    const basePrice = parseFloat(savingsPreviewAmount.dataset.basePrice.replace(/,/g, ''));
    const qty = parseInt(savingsPreviewAmount.dataset.qty);

    // Find the discount percentage from the product card's discount badge
    const productCard = savingsPreviewAmount.closest('.product-card');
    const discountLabel = productCard.querySelector('.discount-label');
    const discountText = discountLabel.textContent;
    const discountPercentage = parseInt(discountText.replace(/[^\d]/g, ''));
    const discountRate = discountPercentage / 100;

    const regularTotal = basePrice * qty;
    const discountedTotal = regularTotal * (1 - discountRate);
    const totalSavings = regularTotal - discountedTotal;
    const perItemSavings = totalSavings / qty;

    savingsPreviewAmount.textContent = perItemSavings.toFixed(2);
  });
}

function toggleSavings(event, element) {
  // Prevent navigation to product page
  event.stopPropagation();
  element.classList.toggle('expanded');
}
 function copyToClipboard(text, event) {
    event.stopPropagation();
    navigator.clipboard.writeText(text)
        .then(() => {
            // Show toast notification
            const toast = document.createElement('div');
            toast.classList.add('toast');
            toast.textContent = text + ' SKU copied!';
            document.body.appendChild(toast);
            // Animate toast
            setTimeout(() => {
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 300); // Duration of fade-out
                }, 2000); // Display duration
            }, 100); // Small delay before fade-in
        })
        .catch(err => {
            console.error('Could not copy text: ', err);
            // Fallback toast for error
            const errorToast = document.createElement('div');
            errorToast.classList.add('toast');
            errorToast.textContent = 'Failed to copy SKU. Please try again.';
            errorToast.style.background = '#dc3545';
            document.body.appendChild(errorToast);
            setTimeout(() => {
                errorToast.classList.add('show');
                setTimeout(() => {
                    errorToast.classList.remove('show');
                    setTimeout(() => {
                        if (document.body.contains(errorToast)) {
                            document.body.removeChild(errorToast);
                        }
                    }, 300);
                }, 2000);
            }, 100);
        });
}


// Add to cart functionality with popup
let selectedProductId;
let selectedProductTitle;
let selectedProductImage;
let selectedProductSKU;
let selectedProductPrice;
let selectedProductVariantId;
let selectedProductDiscount;


function openAddToCartPopup(productId, productTitle, productImage, productSKU, productPrice, productVariantId, event) {
    selectedProductId = productId;
    selectedProductTitle = productTitle;
    selectedProductImage = productImage;
    selectedProductSKU = productSKU;
    selectedProductPrice = productPrice;
    selectedProductVariantId = productVariantId;

    // Find the product card to get discount information by using the event target
    const productCard = event.target.closest('.product-card');
    let discountPercentage = 0;
    let finalPrice = productPrice;

    if (productCard) {
        const discountLabel = productCard.querySelector('.discount-label');
        if (discountLabel) {
            const discountText = discountLabel.textContent;
            discountPercentage = parseInt(discountText.replace(/[^\d]/g, ''));

            // Get the actual final price that's already calculated on the card
            const cardFinalPrice = productCard.querySelector('.final-price');
            if (cardFinalPrice) {
                const finalPriceText = cardFinalPrice.textContent.replace('$', '');
                finalPrice = parseFloat(finalPriceText) * 100; // Convert back to cents
            } else {
                // Fallback calculation
                finalPrice = productPrice - (productPrice * discountPercentage / 100);
            }
        }
    }

    selectedProductDiscount = discountPercentage;

    // Helper function to format price
    function formatPrice(price) {
        const priceInNumber = Number(price);
        // Always show 2 decimal places for consistency
        return priceInNumber.toFixed(2);
    }

    // Populate popup content
    document.getElementById('popupProductImage').src = productImage;
    document.getElementById('popupProductTitle').textContent = productTitle;
    document.getElementById('popupProductSKU').textContent = productSKU;

    // Add the original price to the popup
    const originalPriceElement = document.getElementById('popupOriginalPrice');
    if (productPrice > 0 && selectedProductDiscount > 0){
        originalPriceElement.textContent = '$' + formatPrice(productPrice / 100); // original price
        originalPriceElement.style.display = 'inline';
    }else {
        originalPriceElement.style.display = 'none';
    }

    document.getElementById('popupSalePrice').textContent = formatPrice(productPrice / 100); // Convert from cents
    document.getElementById('popupFinalPrice').textContent = '$' + formatPrice(finalPrice / 100); // Convert from cents
    document.getElementById('popupQuantity').value = 1;

    // Show discount badge with the SAME percentage as the product card
    const discountBadge = document.getElementById('popupDiscountBadge');
    if (discountPercentage > 0) {
        discountBadge.textContent = discountPercentage + '% OFF';
        discountBadge.style.display = 'block';
    } else {
        discountBadge.style.display = 'none';
    }

  // Calculate smart savings for different quantities using the SAME logic as product cards
  const priceInDollars = productPrice / 100;

  // Calculate for 2+ items
  const qty2 = 2;
  const regularTotal2 = priceInDollars * qty2;
  const discountedTotal2 = regularTotal2 * (1 - discountPercentage / 100);
  const totalSavings2 = regularTotal2 - discountedTotal2;
  const perItemSavings2 = totalSavings2 / qty2;

  // Calculate for 3+ items - FIXED: Use correct quantity multiplier
  const qty3 = 3;
  const bulkDiscount3 = discountPercentage + 5; // Additional 5% bulk discount for 3+ items
  const regularTotal3 = priceInDollars * qty3;
  const discountedTotal3 = regularTotal3 * (1 - bulkDiscount3 / 100);
  const totalSavings3 = regularTotal3 - discountedTotal3;
  const perItemSavings3 = totalSavings3 / qty3;

  // Calculate for 5+ items - FIXED: Use correct quantity multiplier
  const qty5 = 5;
  const bulkDiscount5 = discountPercentage + 10; // Additional 10% bulk discount for 5+ items
  const regularTotal5 = priceInDollars * qty5;
  const discountedTotal5 = regularTotal5 * (1 - bulkDiscount5 / 100);
  const totalSavings5 = regularTotal5 - discountedTotal5;
  const perItemSavings5 = totalSavings5 / qty5;

    document.getElementById('popupSavingsPreview').textContent = formatPrice(perItemSavings2);
    document.getElementById('popupSavingsAmount2').textContent = formatPrice(perItemSavings2);
    document.getElementById('popupSavingsAmount3').textContent = formatPrice(perItemSavings3);
    document.getElementById('popupSavingsAmount5').textContent = formatPrice(perItemSavings5);

    // Reset savings selections
    document.querySelectorAll('.popup-savings-option').forEach(option => {
        option.classList.remove('selected');
    });

    // Show overlay first
    const overlay = document.getElementById('overlay');
    const popup = document.getElementById('addToCartPopup');

    overlay.classList.add('show');

    // Small delay for smooth animation
    setTimeout(() => {
        popup.classList.add('show');
    }, 10);

    // Prevent body scroll
    document.body.style.overflow = 'hidden';

    // Ensure Add to Cart button is visible
    const addToCartBtn = document.querySelector('.popup-add-to-cart');
    if (addToCartBtn) {
        addToCartBtn.style.display = 'block';
    }

    // Load current cart info and conditionally show checkout section
    updateCartInfo();
}

function closeAddToCartPopup() {
    const overlay = document.getElementById('overlay');
    const popup = document.getElementById('addToCartPopup');

    popup.classList.remove('show');

    setTimeout(() => {
        overlay.classList.remove('show');
        document.body.style.overflow = '';

        // Clean up any dynamically created checkout sections
        const checkoutSection = document.querySelector('.popup-checkout-section');
        if (checkoutSection) {
            checkoutSection.remove();
        }
    }, 300);
}

function increaseQuantity() {
    const quantityInput = document.getElementById('popupQuantity');
    const currentValue = parseInt(quantityInput.value);
    quantityInput.value = currentValue + 1;
}

function decreaseQuantity() {
    const quantityInput = document.getElementById('popupQuantity');
    const currentValue = parseInt(quantityInput.value);
    if (currentValue > 1) {
        quantityInput.value = currentValue - 1;
    }
}

function togglePopupSavings(element) {
    element.classList.toggle('expanded');
}

function selectSavingsOption(quantity) {
    // Remove selected class from all options
    document.querySelectorAll('.popup-savings-option').forEach(option => {
        option.classList.remove('selected');
    });

    // Add selected class to clicked option
    document.querySelector(`.popup-savings-${quantity}`).classList.add('selected');

    // Update quantity input
    document.getElementById('popupQuantity').value = quantity;

    // Don't auto-add to cart - let user click Add to Cart button
    // This gives users more control over their purchase
}

function addToCart() {
    const quantity = document.getElementById('popupQuantity').value;

    // Add to cart via AJAX instead of redirect
    fetch('/cart/add.js', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            id: selectedProductVariantId,
            quantity: parseInt(quantity)
        })
    })
    .then(response => response.json())
    .then(data => {
        // Show success notification
        showAddToCartSuccess();

        // Update cart count and show checkout section now that cart has items
        updateCartInfo();

        // Reset quantity to 1 after adding
        document.getElementById('popupQuantity').value = 1;

        // Keep the Add to Cart button visible alongside checkout options
        const addToCartBtn = document.querySelector('.popup-add-to-cart');
        if (addToCartBtn) {
            addToCartBtn.style.display = 'block';
        }
    })
    .catch(error => {
        console.error('Error adding to cart:', error);
        showAddToCartError();
    });
}

function showAddToCartSuccess() {
    // Create and show success notification
    const notification = document.createElement('div');
    notification.classList.add('cart-notification', 'success');
    notification.innerHTML = `
        <div class="notification-content">
            <span class="notification-icon">✓</span>
            <span class="notification-text">Product added to cart successfully!</span>
        </div>
    `;
    document.body.appendChild(notification);

    setTimeout(() => {
        notification.classList.add('show');
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }, 100);
}

function showAddToCartError() {
    const notification = document.createElement('div');
    notification.classList.add('cart-notification', 'error');
    notification.innerHTML = `
        <div class="notification-content">
            <span class="notification-icon">✗</span>
            <span class="notification-text">Failed to add product to cart. Please try again.</span>
        </div>
    `;
    document.body.appendChild(notification);

    setTimeout(() => {
        notification.classList.add('show');
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }, 100);
}

// Global cart info
let currentCartCount = 0;
let currentCartTotal = 0;

function updateCartInfo() {
    // Fetch current cart information
    fetch('/cart.js')
    .then(response => response.json())
    .then(cart => {
        currentCartCount = cart.item_count;
        currentCartTotal = cart.total_price;

        // Only update checkout button if there are items in cart
        if (currentCartCount > 0) {
            updateCheckoutButton();
        } else {
            // Remove checkout section if cart is empty
            const checkoutSection = document.querySelector('.popup-checkout-section');
            if (checkoutSection) {
                checkoutSection.remove();
            }
        }
    })
    .catch(error => {
        console.error('Error fetching cart:', error);
    });
}

function updateCheckoutButton() {
    // Create or update checkout section if it doesn't exist
    let checkoutSection = document.querySelector('.popup-checkout-section');

    if (!checkoutSection) {
        checkoutSection = document.createElement('div');
        checkoutSection.classList.add('popup-checkout-section');

        // Insert after the add to cart button
        const addToCartButton = document.querySelector('.popup-add-to-cart');
        addToCartButton.parentNode.insertBefore(checkoutSection, addToCartButton.nextSibling);
    }

    // Get actual products from the page (excluding current product)
    const relatedProducts = getRelatedProducts();

    let relatedProductsHTML = '';
    if (relatedProducts.length > 0) {
        relatedProductsHTML = `
            <div class="related-products-section">
                <h3>You might also like</h3>
                <div class="related-products-grid">
                    ${relatedProducts.map(product => `
                        <div class="related-product-card" onclick="openRelatedProduct('${product.id}', '${product.title.replace(/'/g, "\\'")}', '${product.image}', '${product.sku}', ${product.price}, ${product.variantId})">
                            <div class="related-product-image">
                                <img src="${product.image}" alt="${product.title}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="related-placeholder" style="display: none;">📦</div>
                            </div>
                            <div class="related-product-info">
                                <h4>${product.title}</h4>
                                <div class="related-product-price">
                                    <span class="related-sale-price">$${(product.price / 100).toFixed(2)}</span>
                                    <span class="related-final-price">$${(product.finalPrice / 100).toFixed(2)}</span>
                                </div>
                                <div class="related-discount-badge">${product.discount}% OFF</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    } else {
        relatedProductsHTML = `
            <div class="related-products-section">
                <h3>You might also like</h3>
                <p>More products available on this page...</p>
            </div>
        `;
    }

    const cartText = `🛒 Checkout (${currentCartCount} items - $${(currentCartTotal / 100).toFixed(2)})`;

    checkoutSection.innerHTML = `
        <div class="checkout-buttons">
            <button class="checkout-btn primary" onclick="proceedToCheckout()">
                <span class="checkout-icon"></span>
                ${cartText}
            </button>
            <button class="checkout-btn secondary" onclick="continueShopping()">
                Continue Shopping
            </button>
        </div>
        ${relatedProductsHTML}
    `;
}

function getRelatedProducts() {
    const allProductCards = document.querySelectorAll('.product-card');
    const relatedProducts = [];

    // Get up to 2 random products that are not the current one
    const availableProducts = Array.from(allProductCards).filter(card => {
        const cardSku = card.querySelector('.product-sku')?.textContent.trim();
        return cardSku && cardSku !== selectedProductSKU;
    });

    // Shuffle and take first 2
    const shuffled = availableProducts.sort(() => 0.5 - Math.random());
    const selectedCards = shuffled.slice(0, 2);

    selectedCards.forEach(card => {
        const title = card.querySelector('.product-title')?.textContent.trim();
        const sku = card.querySelector('.product-sku')?.textContent.trim();
        const image = card.querySelector('.product-image img')?.src;
        const salePrice = card.querySelector('.sale-price')?.textContent.replace('$', '').replace(/,/g, '');
        const finalPrice = card.querySelector('.final-price')?.textContent.replace('$', '').replace(/,/g, '');
        const discountLabel = card.querySelector('.discount-label')?.textContent;
        const discount = discountLabel ? parseInt(discountLabel.replace(/[^\d]/g, '')) : 0;

        // Get product ID and variant ID from the Shop Now button
        const shopButton = card.querySelector('.product-cta');
        const onclickAttr = shopButton?.getAttribute('onclick');
        let productId = null;
        let variantId = null;

        if (onclickAttr) {
            const matches = onclickAttr.match(/openAddToCartPopupWithEvent\([^,]+,\s*(\d+),.*?,.*?,.*?,.*?,\s*(\d+)\)/);
            if (matches) {
                productId = matches[1];
                variantId = matches[2];
            }
        }

        if (title && sku && image && salePrice && finalPrice && productId && variantId) {
            relatedProducts.push({
                id: productId,
                title: title,
                sku: sku,
                image: image,
                price: Math.round(parseFloat(salePrice) * 100), // Convert to cents
                finalPrice: Math.round(parseFloat(finalPrice) * 100), // Convert to cents
                discount: discount,
                variantId: variantId
            });
        }
    });

    return relatedProducts;
}

function openRelatedProduct(productId, productTitle, productImage, productSKU, productPrice, productVariantId) {
    // Close current popup
    closeAddToCartPopup();

    // Small delay then open new popup
    setTimeout(() => {
        // Create a fake event object
        const fakeEvent = {
            target: document.querySelector(`[onclick*="${productId}"]`),
            stopPropagation: () => {}
        };

        openAddToCartPopup(productId, productTitle, productImage, productSKU, productPrice, productVariantId, fakeEvent);
    }, 300);
}

function proceedToCheckout() {
    // Redirect to Shopify checkout page directly
    window.location.href = '/checkout';
}

function continueShopping() {
    closeAddToCartPopup();
}

function addRelatedProduct(sku, title, price) {
    // Add related product to cart
    fetch('/cart/add.js', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            id: sku, // You may need to map SKU to variant ID
            quantity: 1
        })
    })
    .then(response => response.json())
    .then(data => {
        showAddToCartSuccess();
    })
    .catch(error => {
        console.error('Error adding related product:', error);
        showAddToCartError();
    });
}

// Start countdown when page loads
document.addEventListener('DOMContentLoaded', function() {
  updateCountdown();
  calculatePricesAndSavings();

  // Initialize cart info
  updateCartInfo();
});
</script>