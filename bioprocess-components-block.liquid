
{% comment %}
  Bioprocess Components Block
  Displays menu items as circular component cards with images, titles, and links
{% endcomment %}

{% if section.settings.menu_handle != blank %}
  {% assign menu = linklists[section.settings.menu_handle] %}
  
  {% if menu.links.size > 0 %}
    <section class="bioprocess-components-section" style="
      background-color: {{ section.settings.background_color }};
      padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px 0;
    ">
      <div class="container">
        {% if section.settings.section_title != blank %}
          <div class="bioprocess-components-header">
            <h2 class="bioprocess-components-title" style="
              color: {{ section.settings.title_color }};
              font-size: {{ section.settings.title_size }}px;
              text-align: {{ section.settings.title_alignment }};
              margin-bottom: {{ section.settings.title_margin_bottom }}px;
            ">
              {{ section.settings.section_title }}
            </h2>
          </div>
        {% endif %}

        <div class="bioprocess-components-grid" style="
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax({{ section.settings.component_width }}px, 1fr));
          gap: {{ section.settings.grid_gap }}px;
          justify-items: center;
          align-items: start;
        ">
          {% for link in menu.links %}
            {% assign link_collection = link.object %}
            <div class="bioprocess-component-item">
              <a href="{{ link.url }}" class="bioprocess-component-link" style="
                text-decoration: none;
                color: inherit;
                display: block;
                transition: transform 0.3s ease;
              ">
                <div class="bioprocess-component-card" style="
                  text-align: center;
                  padding: {{ section.settings.card_padding }}px;
                ">
                  <div class="bioprocess-component-image-wrapper" style="
                    width: {{ section.settings.image_size }}px;
                    height: {{ section.settings.image_size }}px;
                    margin: 0 auto {{ section.settings.image_margin_bottom }}px auto;
                    border-radius: 50%;
                    overflow: hidden;
                    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
                    background-color: {{ section.settings.image_background }};
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                  ">
                    {% if link_collection and link_collection.image %}
                      <img src="{{ link_collection.image | img_url: 'master' }}" 
                           alt="{{ link.title | escape }}" 
                           style="
                             width: 100%;
                             height: 100%;
                             object-fit: cover;
                             display: block;
                           " />
                    {% elsif link_collection and link_collection.products.first %}
                      <img src="{{ link_collection.products.first.featured_image | img_url: 'master' }}" 
                           alt="{{ link.title | escape }}" 
                           style="
                             width: 100%;
                             height: 100%;
                             object-fit: cover;
                             display: block;
                           " />
                    {% else %}
                      <div style="
                        width: 60%;
                        height: 60%;
                        background-color: #e8e8e8;
                        border-radius: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: #999;
                        font-size: 12px;
                      ">
                        No Image
                      </div>
                    {% endif %}
                  </div>
                  
                  <div class="bioprocess-component-title" style="
                    font-size: {{ section.settings.component_title_size }}px;
                    color: {{ section.settings.component_title_color }};
                    font-weight: {{ section.settings.component_title_weight }};
                    line-height: 1.3;
                    margin: 0;
                    transition: color 0.3s ease;
                  ">
                    {{ link.title }}
                  </div>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      </div>
    </section>

    <style>
      .bioprocess-component-link:hover .bioprocess-component-image-wrapper {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        border-color: {{ section.settings.hover_border_color }};
      }
      
      .bioprocess-component-link:hover .bioprocess-component-title {
        color: {{ section.settings.hover_title_color }};
      }
      
      @media (max-width: 768px) {
        .bioprocess-components-grid {
          grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)) !important;
          gap: 20px !important;
        }
        
        .bioprocess-component-image-wrapper {
          width: {{ section.settings.image_size | minus: 20 }}px !important;
          height: {{ section.settings.image_size | minus: 20 }}px !important;
        }
        
        .bioprocess-components-title {
          font-size: {{ section.settings.title_size | minus: 6 }}px !important;
        }
        
        .bioprocess-component-title {
          font-size: {{ section.settings.component_title_size | minus: 2 }}px !important;
        }
      }
      
      @media (max-width: 480px) {
        .bioprocess-components-grid {
          grid-template-columns: repeat(2, 1fr) !important;
        }
      }
    </style>
  {% endif %}
{% endif %}

{% schema %}
{
  "name": "Bioprocess Components Block",
  "tag": "section",
  "class": "bioprocess-components-block",
  "settings": [
    {
      "type": "header",
      "content": "General Settings"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Bioprocess Components"
    },
    {
      "type": "link_list",
      "id": "menu_handle",
      "label": "Menu",
      "info": "Select the menu containing your bioprocess component links"
    },
    {
      "type": "header",
      "content": "Section Styling"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Bottom Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 60
    },
    {
      "type": "header",
      "content": "Title Settings"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#0071b9"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Title Font Size",
      "min": 20,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 32
    },
    {
      "type": "select",
      "id": "title_alignment",
      "label": "Title Alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "title_margin_bottom",
      "label": "Title Bottom Margin",
      "min": 10,
      "max": 60,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "header",
      "content": "Grid Layout"
    },
    {
      "type": "range",
      "id": "component_width",
      "label": "Component Minimum Width",
      "min": 120,
      "max": 200,
      "step": 10,
      "unit": "px",
      "default": 150
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Grid Gap",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 30
    },
    {
      "type": "header",
      "content": "Component Card Settings"
    },
    {
      "type": "range",
      "id": "card_padding",
      "label": "Card Padding",
      "min": 5,
      "max": 30,
      "step": 5,
      "unit": "px",
      "default": 15
    },
    {
      "type": "range",
      "id": "image_size",
      "label": "Image Size",
      "min": 80,
      "max": 150,
      "step": 10,
      "unit": "px",
      "default": 120
    },
    {
      "type": "range",
      "id": "image_margin_bottom",
      "label": "Image Bottom Margin",
      "min": 10,
      "max": 30,
      "step": 5,
      "unit": "px",
      "default": 15
    },
    {
      "type": "color",
      "id": "image_background",
      "label": "Image Background Color",
      "default": "#f8f9fa"
    },
    {
      "type": "header",
      "content": "Border Settings"
    },
    {
      "type": "range",
      "id": "border_width",
      "label": "Border Width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "default": 2
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "#e1e5e9"
    },
    {
      "type": "color",
      "id": "hover_border_color",
      "label": "Hover Border Color",
      "default": "#0071b9"
    },
    {
      "type": "header",
      "content": "Component Title Settings"
    },
    {
      "type": "range",
      "id": "component_title_size",
      "label": "Component Title Font Size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "color",
      "id": "component_title_color",
      "label": "Component Title Color",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "hover_title_color",
      "label": "Hover Title Color",
      "default": "#0071b9"
    },
    {
      "type": "select",
      "id": "component_title_weight",
      "label": "Component Title Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "500"
    }
  ],
  "presets": [
    {
      "name": "Bioprocess Components",
      "category": "Product"
    }
  ]
}
{% endschema %}
