
{% comment %}
  Bioprocess Components Block
  Displays menu items as circular component cards with images, titles, and links
{% endcomment %}

{% if section.settings.menu_handle != blank %}
  {% assign menu = linklists[section.settings.menu_handle] %}
  
  {% if menu.links.size > 0 %}
    <section class="bioprocess-components-section" style="
      background-color: {{ settings.bioprocess_background_color | default: '#ffffff' }};
      padding: {{ settings.bioprocess_padding_top | default: 60 }}px 0 {{ settings.bioprocess_padding_bottom | default: 60 }}px 0;
    ">
      <div class="container">
        {% if section.settings.section_title != blank %}
          <div class="bioprocess-components-header">
            <h2 class="bioprocess-components-title" style="
              color: {{ settings.bioprocess_title_color | default: '#0071b9' }};
              font-size: {{ settings.bioprocess_title_size | default: 32 }}px;
              text-align: {{ settings.bioprocess_title_alignment | default: 'center' }};
              margin-bottom: {{ settings.bioprocess_title_margin_bottom | default: 40 }}px;
            ">
              {{ section.settings.section_title }}
            </h2>
          </div>
        {% endif %}

        <div class="bioprocess-components-grid" style="
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax({{ settings.bioprocess_component_width | default: 150 }}px, 1fr));
          gap: {{ settings.bioprocess_grid_gap | default: 30 }}px;
          justify-items: center;
          align-items: start;
        ">
          {% for link in menu.links %}
            {% assign link_collection = link.object %}
            <div class="bioprocess-component-item">
              <a href="{{ link.url }}" class="bioprocess-component-link" style="
                text-decoration: none;
                color: inherit;
                display: block;
                transition: transform 0.3s ease;
              ">
                <div class="bioprocess-component-card" style="
                  text-align: center;
                  padding: {{ settings.bioprocess_card_padding | default: 15 }}px;
                ">
                  <div class="bioprocess-component-image-wrapper" style="
                    width: {{ settings.bioprocess_image_size | default: 120 }}px;
                    height: {{ settings.bioprocess_image_size | default: 120 }}px;
                    margin: 0 auto {{ settings.bioprocess_image_margin_bottom | default: 15 }}px auto;
                    border-radius: 50%;
                    overflow: hidden;
                    border: {{ settings.bioprocess_border_width | default: 2 }}px solid {{ settings.bioprocess_border_color | default: '#e1e5e9' }};
                    background-color: {{ settings.bioprocess_image_background | default: '#f8f9fa' }};
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                  ">
                    {% if link_collection and link_collection.image %}
                      <img src="{{ link_collection.image | img_url: 'master' }}" 
                           alt="{{ link.title | escape }}" 
                           style="
                             width: 100%;
                             height: 100%;
                             object-fit: cover;
                             display: block;
                           " />
                    {% elsif link_collection and link_collection.products.first %}
                      <img src="{{ link_collection.products.first.featured_image | img_url: 'master' }}" 
                           alt="{{ link.title | escape }}" 
                           style="
                             width: 100%;
                             height: 100%;
                             object-fit: cover;
                             display: block;
                           " />
                    {% else %}
                      <div style="
                        width: 60%;
                        height: 60%;
                        background-color: #e8e8e8;
                        border-radius: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: #999;
                        font-size: 12px;
                      ">
                        No Image
                      </div>
                    {% endif %}
                  </div>
                  
                  <div class="bioprocess-component-title" style="
                    font-size: {{ settings.bioprocess_component_title_size | default: 14 }}px;
                    color: {{ settings.bioprocess_component_title_color | default: '#333333' }};
                    font-weight: {{ settings.bioprocess_component_title_weight | default: '500' }};
                    line-height: 1.3;
                    margin: 0;
                    transition: color 0.3s ease;
                  ">
                    {{ link.title }}
                  </div>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      </div>
    </section>

    <style>
      .bioprocess-component-link:hover .bioprocess-component-image-wrapper {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        border-color: {{ settings.bioprocess_hover_border_color | default: '#0071b9' }};
      }
      
      .bioprocess-component-link:hover .bioprocess-component-title {
        color: {{ settings.bioprocess_hover_title_color | default: '#0071b9' }};
      }
      
      @media (max-width: 768px) {
        .bioprocess-components-grid {
          grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)) !important;
          gap: 20px !important;
        }
        
        .bioprocess-component-image-wrapper {
          width: {{ settings.bioprocess_image_size | default: 120 | minus: 20 }}px !important;
          height: {{ settings.bioprocess_image_size | default: 120 | minus: 20 }}px !important;
        }
        
        .bioprocess-components-title {
          font-size: {{ settings.bioprocess_title_size | default: 32 | minus: 6 }}px !important;
        }
        
        .bioprocess-component-title {
          font-size: {{ settings.bioprocess_component_title_size | default: 14 | minus: 2 }}px !important;
        }
      }
      
      @media (max-width: 480px) {
        .bioprocess-components-grid {
          grid-template-columns: repeat(2, 1fr) !important;
        }
      }
    </style>
  {% endif %}
{% endif %}

{% schema %}
{
  "name": "Components Block",
  "tag": "section",
  "class": "bioprocess-components-block",
  "settings": [
    {
      "type": "header",
      "content": "General Settings"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Bioprocess Components"
    },
    {
      "type": "link_list",
      "id": "menu_handle",
      "label": "Menu",
      "info": "Select the menu containing your bioprocess component links"
    }
  ],
  "presets": [
    {
      "name": "Components Block",
      "category": "Product"
    }
  ]
}
{% endschema %}
