
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Not Found - {{ shop.name }}</title>
    <style>
        .error-404-page * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .error-404-page {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .error-404-page .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        .error-404-page .header-section {
            text-align: center;
            padding: 40px 0;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .error-404-page .error-code {
            font-size: 120px;
            font-weight: bold;
            color: #3378c2;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .error-404-page .error-title {
            font-size: 32px;
            color: #333;
            margin-bottom: 15px;
        }

        .error-404-page .error-message {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .error-404-page .search-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .error-404-page .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .error-404-page .search-input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .error-404-page .search-input:focus {
            outline: none;
            border-color: #3378c2;
        }

        .error-404-page .search-btn {
            padding: 15px 30px;
            background: #3378c2;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .error-404-page .search-btn:hover {
            background: #2a5f9e;
        }

        .error-404-page .suggestions-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .error-404-page .section-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 25px;
            text-align: center;
        }

        .error-404-page .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .error-404-page .product-card {
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            background: white;
        }

        .error-404-page .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .error-404-page .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .error-404-page .product-info {
            padding: 15px;
        }

        .error-404-page .product-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .error-404-page .product-price {
            font-size: 18px;
            color: #3378c2;
            font-weight: bold;
        }

        .error-404-page .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .error-404-page .quick-link {
            display: block;
            padding: 15px 20px;
            background: #f8f9fa;
            color: #333;
            text-decoration: none;
            border-radius: 8px;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .error-404-page .quick-link:hover {
            background: #3378c2;
            color: white;
            border-color: #3378c2;
        }

        .error-404-page .help-section {
            background: #3378c2;
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }

        .error-404-page .help-title {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .error-404-page .help-text {
            font-size: 16px;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .error-404-page .contact-btn {
            display: inline-block;
            padding: 12px 25px;
            background: white;
            color: #3378c2;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            transition: transform 0.3s;
        }

        .error-404-page .contact-btn:hover {
            transform: scale(1.05);
        }

        .error-404-page .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error-404-page .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3378c2;
            border-radius: 50%;
            animation: error-404-spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes error-404-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .error-404-page .error-code {
                font-size: 80px;
            }
            
            .error-404-page .error-title {
                font-size: 24px;
            }
            
            .error-404-page .search-box {
                flex-direction: column;
            }
            
            .error-404-page .products-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
    </style>
</head>
<body class="error-404-page">
    <div class="container">
        <div class="header-section">
            <div class="error-code">404</div>
            <h1 class="error-title">Oops! We couldn't find what you're looking for</h1>
            <p class="error-message" id="dynamic-message">
                The page you requested might have been moved, deleted, or doesn't exist.
            </p>
        </div>

        <div class="search-section">
            <h2 class="section-title">Let's find what you need</h2>
            <div class="search-box">
                <input type="text" class="search-input" id="search-input" placeholder="Search for products, collections, or pages...">
                <button class="search-btn" onclick="performSearch()">Search</button>
            </div>
        </div>

        <div class="suggestions-section">
            <h2 class="section-title">You might be interested in</h2>
            <div id="related-content">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Finding related products for you...</p>
                </div>
            </div>
        </div>

        <div class="suggestions-section">
            <h2 class="section-title">Popular Categories</h2>
            <div class="quick-links">
                <a href="/collections/all" class="quick-link">All Products</a>
                <a href="/collections/standard-sut" class="quick-link">Standard SUT</a>
                <a href="/collections/mto-sut" class="quick-link">MTO SUT</a>
                <a href="/collections/bioprocess-components" class="quick-link">Bioprocess Components</a>
                <a href="/collections/bottle-assemblies" class="quick-link">Bottle Assemblies</a>
                <a href="/collections/carboys" class="quick-link">Carboys</a>
                <a href="/pages/process-custom-sut" class="quick-link">Custom SUT</a>
                <a href="/pages/contact" class="quick-link">Contact Us</a>
            </div>
        </div>

        <div class="help-section">
            <h2 class="help-title">Need Help?</h2>
            <p class="help-text">Our team is here to assist you with finding the right products or answering any questions.</p>
            <a href="/pages/contact" class="contact-btn">Contact Support</a>
        </div>
    </div>

    <script>
        // Get the current URL to analyze what the user was looking for
        const currentUrl = window.location.pathname;
        const referrer = document.referrer;

        // Advanced algorithm to determine context and show relevant content
        function analyzeUserIntent() {
            let context = 'general';
            let keywords = [];
            
            // Analyze URL path
            if (currentUrl.includes('/products/')) {
                context = 'product';
                const productHandle = currentUrl.split('/products/')[1];
                if (productHandle) {
                    keywords = extractKeywords(productHandle);
                }
            } else if (currentUrl.includes('/collections/')) {
                context = 'collection';
                const collectionHandle = currentUrl.split('/collections/')[1];
                if (collectionHandle) {
                    keywords = extractKeywords(collectionHandle);
                }
            } else if (currentUrl.includes('/pages/')) {
                context = 'page';
                const pageHandle = currentUrl.split('/pages/')[1];
                if (pageHandle) {
                    keywords = extractKeywords(pageHandle);
                }
            }

            return { context, keywords };
        }

        function extractKeywords(handle) {
            return handle.split(/[-_]/).filter(word => word.length > 2);
        }

        function updateDynamicMessage() {
            const { context, keywords } = analyzeUserIntent();
            const messageElement = document.getElementById('dynamic-message');
            
            let message = '';
            
            switch (context) {
                case 'product':
                    message = `The product you're looking for might have been discontinued or moved. Let us help you find similar laboratory equipment.`;
                    break;
                case 'collection':
                    message = `This product category might have been reorganized. Explore our related collections below.`;
                    break;
                case 'page':
                    message = `The page you're looking for might have been updated or moved. Check out our popular sections below.`;
                    break;
                default:
                    message = `The page you requested might have been moved, deleted, or doesn't exist. Let's help you find what you need.`;
            }
            
            messageElement.textContent = message;
        }

        async function loadRelatedContent() {
            const { context, keywords } = analyzeUserIntent();
            const relatedContent = document.getElementById('related-content');
            
            try {
                // Simulate API call to get related products
                const products = await fetchRelatedProducts(context, keywords);
                renderProducts(products);
            } catch (error) {
                console.error('Error loading related content:', error);
                relatedContent.innerHTML = `
                    <div class="quick-links">
                        <a href="/collections/all" class="quick-link">Browse All Products</a>
                        <a href="/collections/featured" class="quick-link">Featured Products</a>
                        <a href="/collections/new" class="quick-link">New Arrivals</a>
                        <a href="/collections/best-sellers" class="quick-link">Best Sellers</a>
                    </div>
                `;
            }
        }

        async function fetchRelatedProducts(context, keywords) {
            // In a real implementation, this would call your Shopify API
            // For now, we'll return some mock data based on context
            
            const allProducts = [
                {
                    title: "Standard SUT Assembly",
                    price: "$125.00",
                    image: "https://cdn.shopify.com/s/files/1/0621/4805/1160/files/standard-sut-placeholder.jpg",
                    url: "/collections/standard-sut"
                },
                {
                    title: "Custom Bioprocess Components",
                    price: "$89.00",
                    image: "https://cdn.shopify.com/s/files/1/0621/4805/1160/files/bioprocess-placeholder.jpg",
                    url: "/collections/bioprocess-components"
                },
                {
                    title: "Laboratory Bottle Assembly",
                    price: "$65.00",
                    image: "https://cdn.shopify.com/s/files/1/0621/4805/1160/files/bottle-assembly-placeholder.jpg",
                    url: "/collections/bottle-assemblies"
                },
                {
                    title: "HDPE Carboy System",
                    price: "$210.00",
                    image: "https://cdn.shopify.com/s/files/1/0621/4805/1160/files/carboy-placeholder.jpg",
                    url: "/collections/carboys"
                }
            ];

            // Filter products based on keywords and context
            return allProducts.slice(0, 4);
        }

        function renderProducts(products) {
            const relatedContent = document.getElementById('related-content');
            
            const productsHTML = `
                <div class="products-grid">
                    ${products.map(product => `
                        <div class="product-card">
                            <img src="${product.image}" alt="${product.title}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDI1MCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyNTAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjVmNWY1Ii8+Cjx0ZXh0IHg9IjEyNSIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOTk5IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                            <div class="product-info">
                                <h3 class="product-title">${product.title}</h3>
                                <p class="product-price">${product.price}</p>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            relatedContent.innerHTML = productsHTML;
        }

        function performSearch() {
            const query = document.getElementById('search-input').value.trim();
            if (query) {
                window.location.href = `/search?q=${encodeURIComponent(query)}`;
            }
        }

        // Handle Enter key in search input
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            updateDynamicMessage();
            loadRelatedContent();
            
            // Pre-fill search with potential keywords
            const { keywords } = analyzeUserIntent();
            if (keywords.length > 0) {
                document.getElementById('search-input').placeholder = `Try searching for "${keywords[0]}"...`;
            }
        });

        // Track 404 events for analytics (if needed)
        if (typeof gtag !== 'undefined') {
            gtag('event', '404_error', {
                'page_location': window.location.href,
                'page_referrer': document.referrer
            });
        }
    </script>
</body>
</html>
